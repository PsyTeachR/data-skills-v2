<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 7 Belonging analysis | Data Skills</title>
<meta name="author" content="Emily Nordmann">
<meta name="description" content="# Load necessary libraries library(tidyverse) # Set seed for reproducibility set.seed(123) # Define number of participants n_participants &lt;- 1000 # Define genders and age gender &lt;- c(rep('1',...">
<meta name="generator" content="bookdown 0.34 with bs4_book()">
<meta property="og:title" content="Chapter 7 Belonging analysis | Data Skills">
<meta property="og:type" content="book">
<meta property="og:url" content="https://psyteachr.github.io/data-skills-v2/belonging-analysis.html">
<meta property="og:image" content="https://psyteachr.github.io/data-skills-v2/images/logos/logo.png">
<meta property="og:description" content="# Load necessary libraries library(tidyverse) # Set seed for reproducibility set.seed(123) # Define number of participants n_participants &lt;- 1000 # Define genders and age gender &lt;- c(rep('1',...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 7 Belonging analysis | Data Skills">
<meta name="twitter:description" content="# Load necessary libraries library(tidyverse) # Set seed for reproducibility set.seed(123) # Define number of participants n_participants &lt;- 1000 # Define genders and age gender &lt;- c(rep('1',...">
<meta name="twitter:image" content="https://psyteachr.github.io/data-skills-v2/images/logos/logo.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.2/transition.js"></script><script src="libs/bs3compat-0.4.2/tabs.js"></script><script src="libs/bs3compat-0.4.2/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-6NP3MF25W3"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-6NP3MF25W3');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="include/psyteachr.css">
<link rel="stylesheet" href="include/webex.css">
<link rel="stylesheet" href="include/style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Data Skills</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Overview</a></li>
<li><a class="" href="sec-intro.html"><span class="header-section-number">1</span> Intro to R and RStudio</a></li>
<li><a class="" href="stroop.html"><span class="header-section-number">2</span> Intro to Stroop effect</a></li>
<li><a class="" href="stroop-analysis.html"><span class="header-section-number">3</span> Stroop analysis</a></li>
<li><a class="" href="homework-1.html"><span class="header-section-number">4</span> Homework 1</a></li>
<li><a class="" href="corsi-analysis.html"><span class="header-section-number">5</span> Corsi analysis</a></li>
<li><a class="" href="intro-to-belonging.html"><span class="header-section-number">6</span> Intro to Belonging</a></li>
<li><a class="active" href="belonging-analysis.html"><span class="header-section-number">7</span> Belonging analysis</a></li>
<li class="book-part">Appendices</li>
<li><a class="" href="installing-r.html"><span class="header-section-number">A</span> Installing R</a></li>
<li><a class="" href="symbols.html"><span class="header-section-number">B</span> Symbols</a></li>
<li><a class="" href="conventions.html"><span class="header-section-number">C</span> Conventions</a></li>
<li><a class="" href="glossary-1.html"><span class="header-section-number">D</span> Glossary</a></li>
<li><a class="" href="license.html">License</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/psyteachr/data-skills-v2">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="belonging-analysis" class="section level1" number="7">
<h1>
<span class="header-section-number">7</span> Belonging analysis<a class="anchor" aria-label="anchor" href="#belonging-analysis"><i class="fas fa-link"></i></a>
</h1>
<div class="sourceCode" id="cb107"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load necessary libraries</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set seed for reproducibility</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define number of participants</span></span>
<span><span class="va">n_participants</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span></span>
<span><span class="co"># Define genders and age</span></span>
<span><span class="va">gender</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">'1'</span>, <span class="va">n_participants</span> <span class="op">*</span> <span class="fl">0.4</span><span class="op">)</span>, </span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">'2'</span>, <span class="va">n_participants</span> <span class="op">*</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">'3'</span>, <span class="va">n_participants</span> <span class="op">*</span> <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">age</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">17</span><span class="op">:</span><span class="fl">25</span>, <span class="va">n_participants</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">level</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">'First year'</span>, <span class="va">n_participants</span> <span class="op">*</span> <span class="fl">0.92</span><span class="op">)</span>, </span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">'Second year'</span>, <span class="va">n_participants</span> <span class="op">*</span> <span class="fl">0.08</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Define mean and standard deviation for each scale</span></span>
<span><span class="va">mean_belongingness</span> <span class="op">&lt;-</span> <span class="fl">4.06</span></span>
<span><span class="va">sd_belongingness</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span><span class="va">mean_engagement</span> <span class="op">&lt;-</span> <span class="fl">3.82</span></span>
<span><span class="va">sd_engagement</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span><span class="va">mean_self_confidence</span> <span class="op">&lt;-</span> <span class="fl">3.48</span></span>
<span><span class="va">sd_self_confidence</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span></span>
<span><span class="co"># Correlate the scales</span></span>
<span><span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.4</span>, <span class="fl">0.5</span>,</span>
<span>                  <span class="fl">0.4</span>, <span class="fl">1</span>, <span class="fl">0.7</span>,</span>
<span>                  <span class="fl">0.5</span>, <span class="fl">0.7</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>                nrow<span class="op">=</span><span class="fl">3</span>, ncol<span class="op">=</span><span class="fl">3</span><span class="op">)</span>  <span class="co"># Correlation matrix</span></span>
<span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">mean_belongingness</span>, <span class="va">mean_engagement</span>, <span class="va">mean_self_confidence</span><span class="op">)</span>  <span class="co"># Means</span></span>
<span></span>
<span><span class="co"># Simulate the correlated data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">simulated_scores</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html">mvrnorm</a></span><span class="op">(</span><span class="va">n_participants</span>, <span class="va">mu</span>, <span class="va">sigma</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">simulated_scores</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"belongingness"</span>, <span class="st">"engagement"</span>, <span class="st">"self_confidence"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Adjust for gender effect on self-confidence and engagement</span></span>
<span><span class="va">simulated_scores</span><span class="op">[</span><span class="va">gender</span> <span class="op">==</span> <span class="st">'2'</span>, <span class="st">"self_confidence"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">simulated_scores</span><span class="op">[</span><span class="va">gender</span> <span class="op">==</span> <span class="st">'2'</span>, <span class="st">"self_confidence"</span><span class="op">]</span> <span class="op">+</span> <span class="fl">0.1</span></span>
<span><span class="va">simulated_scores</span><span class="op">[</span><span class="va">gender</span> <span class="op">==</span> <span class="st">'2'</span>, <span class="st">"engagement"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">simulated_scores</span><span class="op">[</span><span class="va">gender</span> <span class="op">==</span> <span class="st">'2'</span>, <span class="st">"engagement"</span><span class="op">]</span> <span class="op">-</span> <span class="fl">0.1</span></span>
<span><span class="va">simulated_scores</span><span class="op">[</span><span class="va">gender</span> <span class="op">==</span> <span class="st">'3'</span>, <span class="st">"self_confidence"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">simulated_scores</span><span class="op">[</span><span class="va">gender</span> <span class="op">==</span> <span class="st">'3'</span>, <span class="st">"self_confidence"</span><span class="op">]</span> <span class="op">-</span> <span class="fl">0.1</span></span>
<span></span>
<span><span class="co"># Adjust for age effect on engagement and self-confidence</span></span>
<span><span class="va">simulated_scores</span><span class="op">[</span>, <span class="st">"engagement"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">simulated_scores</span><span class="op">[</span>, <span class="st">"engagement"</span><span class="op">]</span> <span class="op">+</span> <span class="fl">0.01</span> <span class="op">*</span> <span class="op">(</span><span class="va">age</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">simulated_scores</span><span class="op">[</span>, <span class="st">"self_confidence"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">simulated_scores</span><span class="op">[</span>, <span class="st">"self_confidence"</span><span class="op">]</span> <span class="op">+</span> <span class="fl">0.01</span> <span class="op">*</span> <span class="op">(</span><span class="va">age</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a new dataframe</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>participant <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">n_participants</span>,</span>
<span>                   gender <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">gender</span><span class="op">)</span>,</span>
<span>                   age <span class="op">=</span> <span class="va">age</span>,</span>
<span>                   level <span class="op">=</span> <span class="va">level</span>,</span>
<span>                   belongingness <span class="op">=</span> <span class="va">simulated_scores</span><span class="op">[</span>, <span class="st">"belongingness"</span><span class="op">]</span>,</span>
<span>                   engagement <span class="op">=</span> <span class="va">simulated_scores</span><span class="op">[</span>, <span class="st">"engagement"</span><span class="op">]</span>,</span>
<span>                   self_confidence <span class="op">=</span> <span class="va">simulated_scores</span><span class="op">[</span>, <span class="st">"self_confidence"</span><span class="op">]</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>gender <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">gender</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Round questionnaire data to 2 decimal places</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html">mutate_at</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="va">belongingness</span><span class="op">:</span><span class="va">self_confidence</span><span class="op">)</span>, <span class="va">round</span>, <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Split into demographic and questionnaire data</span></span>
<span><span class="va">demographic_data</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">participant</span>, <span class="va">gender</span>, <span class="va">age</span>, <span class="va">level</span><span class="op">)</span></span>
<span><span class="va">questionnaire_data</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">participant</span>, <span class="va">level</span>, <span class="va">belongingness</span>, <span class="va">engagement</span>, <span class="va">self_confidence</span><span class="op">)</span></span></code></pre></div>
<div id="sec-ilo-belong-analysis" class="section level2" number="7.1">
<h2>
<span class="header-section-number">7.1</span> Intended Learning Outcomes<a class="anchor" aria-label="anchor" href="#sec-ilo-belong-analysis"><i class="fas fa-link"></i></a>
</h2>
<p>By the end of this chapter you should be able to:</p>
<ul>
<li>Debug your code by identifying and fixing a variety of errors</li>
</ul>
</div>
<div id="sec-walkthrough-belong" class="section level2" number="7.2">
<h2>
<span class="header-section-number">7.2</span> Walkthrough video<a class="anchor" aria-label="anchor" href="#sec-walkthrough-belong"><i class="fas fa-link"></i></a>
</h2>
<p>There is a walkthrough video of this chapter available via <a href="">Echo360.</a> (INCOMING) We recommend first trying to work through each section of the book on your own and then watching the video if you get stuck, or if you would like more information. This will feel slower than just starting with the video, but you will learn more in the long-run. Please note that there may have been minor edits to the book since the video was recorded. Where there are differences, the book should always take precedence.</p>
</div>
<div id="error-mode" class="section level2" number="7.3">
<h2>
<span class="header-section-number">7.3</span> Error mode<a class="anchor" aria-label="anchor" href="#error-mode"><i class="fas fa-link"></i></a>
</h2>
<p>For the final chapter of this semester, we're going to try something a bit different. Instead of asking you to write code, we're going to give you code that either won't run and will throw an error, or it will run, but it won't quite do what it's supposed to do. Your job is to debug your code by finding and fixing the errors.</p>
<p>We will give you hints but we won't be giving any solutions. To figure out the answer to each activity you should:</p>
<ul>
<li>Read the error messages</li>
<li>Check the output of any code that runs very carefully, including looking at variable names</li>
<li>Use the search function in this book to look up how to use functions</li>
<li>Talk to your group and try and figure it out together</li>
<li>Google the error messages</li>
</ul>
<p>Once you've figured it out, make notes on what the error was and how you fixed it because there's actually a relatively small set of errors you'll make again and again so it will help you debug future code.</p>
</div>
<div id="activity-1-setup" class="section level2" number="7.4">
<h2>
<span class="header-section-number">7.4</span> Activity 1: Setup<a class="anchor" aria-label="anchor" href="#activity-1-setup"><i class="fas fa-link"></i></a>
</h2>
<p>Login to the server and open <code>belong_stub2.Rmd</code>. To create the errors, you'll need to ensure you're working from a clean environment and new session. If you followed the instructions in Chapter 1, this should happen automatically but just in case, run the following code in code chunk 1 which will clear all objects and unload any packages you have loaded:</p>
<div class="sourceCode" id="cb108"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"package:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">otherPkgs</span><span class="op">)</span>, sep<span class="op">=</span><span class="st">""</span><span class="op">)</span>, </span>
<span>       <span class="va">detach</span>, </span>
<span>       character.only <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>       unload <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="activity-2-load-packages-and-data" class="section level2" number="7.5">
<h2>
<span class="header-section-number">7.5</span> Activity 2: Load packages and data<a class="anchor" aria-label="anchor" href="#activity-2-load-packages-and-data"><i class="fas fa-link"></i></a>
</h2>
<p>With this code, we want to use the function <code><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv()</a></code> from the <code>tidyverse</code> package to load the data into two objects <code>demographic_data</code> and <code>questionnaire_data</code>.</p>
<div class="sourceCode" id="cb109"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">demographic_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"demographic_data.csv"</span><span class="op">)</span></span>
<span><span class="va">questionnaire_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"questionnaire_data.csv"</span><span class="op">)</span></span></code></pre></div>
<div class="webex-solution">
<button>
Hint
</button>
<p>In order to use a function, you must load the package it is in first</p>
</div>
</div>
<div id="activity-3-join-the-datasets" class="section level2" number="7.6">
<h2>
<span class="header-section-number">7.6</span> Activity 3: Join the datasets<a class="anchor" aria-label="anchor" href="#activity-3-join-the-datasets"><i class="fas fa-link"></i></a>
</h2>
<p>With this code, we want to join the two objects <code>demographic_data</code> and <code>questionnaire_data</code> together and save them in an object named <code>full_dat</code>. <code>full_dat</code> should have 1000 rows and 7 variables. This code will run, but it won't produce what you want.</p>
<div class="sourceCode" id="cb110"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">full_dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">demographic_data</span>,</span>
<span>                       y <span class="op">=</span> <span class="va">questionnaire_data</span>, </span>
<span>                       by <span class="op">=</span> <span class="st">"participant"</span>, <span class="st">"level"</span><span class="op">)</span></span></code></pre></div>
<div class="webex-solution">
<button>
Hint
</button>
<p>If you want to pass multiple values to an argument, you need to <code>c</code>ombine them otherwise R will only parse the first value. In the case of <code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join()</a></code>, if R doesn't know that columns are the same in both objects it will create two versions of the column (and distinguish them with<code>.x</code> and <code>.y</code>).</p>
</div>
</div>
<div id="activity-4-filter" class="section level2" number="7.7">
<h2>
<span class="header-section-number">7.7</span> Activity 4: Filter<a class="anchor" aria-label="anchor" href="#activity-4-filter"><i class="fas fa-link"></i></a>
</h2>
<p>Next, we want to filter the questionnaire data to only include first-year students:</p>
<div class="sourceCode" id="cb111"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">first_year</span> <span class="op">&lt;-</span> <span class="va">full_dat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span>level <span class="op">=</span> <span class="st">"First year"</span><span class="op">)</span></span></code></pre></div>
<div class="webex-solution">
<button>
Hint
</button>
<p>This is one of those rare times when reading the error message will give you a clear explanation of what the problem is and how to fix it.</p>
</div>
</div>
<div id="activity-5-mutate-and-recode" class="section level2" number="7.8">
<h2>
<span class="header-section-number">7.8</span> Activity 5: Mutate and recode<a class="anchor" aria-label="anchor" href="#activity-5-mutate-and-recode"><i class="fas fa-link"></i></a>
</h2>
<p>Then, we want to recode gender as a factor. This code will run, but it will introduce an error into your data.</p>
<div class="webex-solution">
<button>
Hint
</button>
<p>Look at the order of the levels and labels and think about what 1, 2, and 3 are supposed to represent.</p>
</div>
<div class="sourceCode" id="cb112"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">first_year</span> <span class="op">&lt;-</span> <span class="va">first_year</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>gender_coded <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">gender</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>,</span>
<span>                         labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Man"</span>, <span class="st">"Woman"</span>, <span class="st">"Non-binary"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="activity-6-select" class="section level2" number="7.9">
<h2>
<span class="header-section-number">7.9</span> Activity 6: Select<a class="anchor" aria-label="anchor" href="#activity-6-select"><i class="fas fa-link"></i></a>
</h2>
<p>This code should use the function <code><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a></code> to select a the columns <code>participant</code>, <code>gender_coded</code>, <code>age</code>, and three questionnaire score columns and rename <code>gender_coded</code> as <code>gender</code>.</p>
<div class="webex-solution">
<button>
Hint
</button>
<p>Typos are the most common cause of code not working. There are two of them in this code.</p>
</div>
<div class="sourceCode" id="cb113"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">first_year</span> <span class="op">&lt;-</span> <span class="va">first_year</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">selct</span><span class="op">(</span><span class="va">Participant</span>, </span>
<span>         <span class="st">"gender"</span> <span class="op">=</span> <span class="va">gender_coded</span>,</span>
<span>         <span class="va">age</span>,</span>
<span>         <span class="va">belongingness</span><span class="op">:</span><span class="va">self_confidence</span><span class="op">)</span> </span></code></pre></div>
</div>
<div id="activity-7-summarise" class="section level2" number="7.10">
<h2>
<span class="header-section-number">7.10</span> Activity 7: Summarise<a class="anchor" aria-label="anchor" href="#activity-7-summarise"><i class="fas fa-link"></i></a>
</h2>
<p>This code should use <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code> and <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise()</a></code> to calculate the mean scores on each belonging sub-scale by gender and save it in an object named <code>scores_gender</code>. The final table should have 4 columns (gender, belong, engagement, and confidence) and three rows (one for each gender).</p>
<div class="webex-solution">
<button>
Hint
</button>
<p>If you're trying to calculate summary statistics by group, you only need to add the variables you want to create stats for to <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code>. If you get more rows of data than you want, you've probably got too many variables in <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code>, if you've got too few rows of data, you've probably not got all the variables you need.</p>
</div>
<div class="sourceCode" id="cb114"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scores_gender</span> <span class="op">&lt;-</span> <span class="va">first_year</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">participant</span>, <span class="va">gender</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>belong <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">belongingness</span><span class="op">)</span>,</span>
<span>            engagement <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">engagement</span><span class="op">)</span>,</span>
<span>            confidence <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">self_confidence</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb115"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">full_dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">demographic_data</span>,</span>
<span>                       y <span class="op">=</span> <span class="va">questionnaire_data</span>, </span>
<span>                       by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"participant"</span>, <span class="st">"level"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">first_year</span> <span class="op">&lt;-</span> <span class="va">full_dat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">level</span> <span class="op">==</span> <span class="st">"First year"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">first_year</span> <span class="op">&lt;-</span> <span class="va">first_year</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>gender_coded <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">gender</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span>,</span>
<span>                         labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Man"</span>, <span class="st">"Woman"</span>, <span class="st">"Non-binary"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">first_year</span> <span class="op">&lt;-</span> <span class="va">first_year</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">participant</span>, </span>
<span>         <span class="st">"gender"</span> <span class="op">=</span> <span class="va">gender_coded</span>,</span>
<span>         <span class="va">age</span>,</span>
<span>         <span class="va">belongingness</span><span class="op">:</span><span class="va">self_confidence</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">scores_gender</span> <span class="op">&lt;-</span> <span class="va">first_year</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">gender</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>belong <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">belongingness</span><span class="op">)</span>,</span>
<span>            engagement <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">engagement</span><span class="op">)</span>,</span>
<span>            confidence <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">self_confidence</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>

</div>
</div>



<div class="chapter-nav">
<div class="prev"><a href="intro-to-belonging.html"><span class="header-section-number">6</span> Intro to Belonging</a></div>
<div class="next"><a href="installing-r.html"><span class="header-section-number">A</span> Installing R</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#belonging-analysis"><span class="header-section-number">7</span> Belonging analysis</a></li>
<li><a class="nav-link" href="#sec-ilo-belong-analysis"><span class="header-section-number">7.1</span> Intended Learning Outcomes</a></li>
<li><a class="nav-link" href="#sec-walkthrough-belong"><span class="header-section-number">7.2</span> Walkthrough video</a></li>
<li><a class="nav-link" href="#error-mode"><span class="header-section-number">7.3</span> Error mode</a></li>
<li><a class="nav-link" href="#activity-1-setup"><span class="header-section-number">7.4</span> Activity 1: Setup</a></li>
<li><a class="nav-link" href="#activity-2-load-packages-and-data"><span class="header-section-number">7.5</span> Activity 2: Load packages and data</a></li>
<li><a class="nav-link" href="#activity-3-join-the-datasets"><span class="header-section-number">7.6</span> Activity 3: Join the datasets</a></li>
<li><a class="nav-link" href="#activity-4-filter"><span class="header-section-number">7.7</span> Activity 4: Filter</a></li>
<li><a class="nav-link" href="#activity-5-mutate-and-recode"><span class="header-section-number">7.8</span> Activity 5: Mutate and recode</a></li>
<li><a class="nav-link" href="#activity-6-select"><span class="header-section-number">7.9</span> Activity 6: Select</a></li>
<li><a class="nav-link" href="#activity-7-summarise"><span class="header-section-number">7.10</span> Activity 7: Summarise</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/psyteachr/data-skills-v2/blob/master/book/08-belong-error.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/psyteachr/data-skills-v2/edit/master/book/08-belong-error.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>
</div>
<script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  if (t = document.getElementById("webex-total_correct")) {
    var correct = document.getElementsByClassName("webex-correct").length;
    var solvemes = document.getElementsByClassName("webex-solveme").length;
    var radiogroups = document.getElementsByClassName("webex-radiogroup").length;
    var selects = document.getElementsByClassName("webex-select").length;

    t.innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");

  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");

  var cl = this.classList

  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;

  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }

  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

window.onload = function() {
  console.log("webex onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;

    $(solveme[i]).after(" <span class='webex-icon'></span>");
  }

  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }

  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
    $(selects[i]).after(" <span class='webex-icon'></span>");
  }

  update_total_correct();
}

</script><script>
$( document ).ready(function() {
  var cite = ' ';
  var psyteachr = ' <a href="https://psyteachr.github.io/"><img src="images/logos/psyteachr_logo.png" style="height: 31px; color: white;" alt="psyTeachR: Reproducible Research" /></a>';
  var license = ' <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/" target="blank"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png"></a>';

  $("footer div.row div:eq(1) p").html(
    psyteachr + license + cite
  );

  // open rdrr links externally
  $("a[href^='https://rdrr.io']").click(function(){
    window.open(this.href);
    return false;
  });

  // visible second sidebar in mobile
  function move_sidebar() {
    var w = window.innerWidth;
    if (w < 992) {
      $("#toc").appendTo($("#main-nav"));
    } else {
      $("#toc").appendTo($("div.sidebar-chapter"));
    }
  }
  move_sidebar();
  window.onresize = move_sidebar;
});
</script>

</div>
 <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Data Skills</strong>" was written by Emily Nordmann. It was last built on 2023-06-09.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
